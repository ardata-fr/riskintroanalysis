<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate weighted border risk — calc_border_risk • riskintroanalysis</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate weighted border risk — calc_border_risk"><meta name="description" content="Calculates the risk of introduction for each epidemiological unit based on the risk of
emission of neighbouring countries. The score is weighted based on the length of
shared borders."><meta property="og:description" content="Calculates the risk of introduction for each epidemiological unit based on the risk of
emission of neighbouring countries. The score is weighted based on the length of
shared borders."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">riskintroanalysis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.012</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate weighted border risk</h1>

      <div class="d-none name"><code>calc_border_risk.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the risk of introduction for each epidemiological unit based on the risk of
emission of neighbouring countries. The score is weighted based on the length of
shared borders.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_border_risk</span><span class="op">(</span><span class="va">epi_units</span>, <span class="va">shared_borders</span>, <span class="va">emission_risk</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-epi-units">epi_units<a class="anchor" aria-label="anchor" href="#arg-epi-units"></a></dt>
<dd><p>epidemiological units dataset</p></dd>


<dt id="arg-shared-borders">shared_borders<a class="anchor" aria-label="anchor" href="#arg-shared-borders"></a></dt>
<dd><p>shared borders dataset as outputted by <code><a href="calc_border_lengths.html">calc_border_lengths()</a></code></p></dd>


<dt id="arg-emission-risk">emission_risk<a class="anchor" aria-label="anchor" href="#arg-emission-risk"></a></dt>
<dd><p>emission risk dataset,</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>sf</code> object containing the border risk score associated with each
epidemiological unit. The table is containing the following columns:</p><ul><li><p><code>eu_id</code>: ID of the epidemiological unit. This will be used as a join key to the
<code>epi_units</code> table and <code>risk_table</code>.</p></li>
<li><p><code>eu_name</code>: Name of the epidemiological unit. This comes from the <code>epi_units</code> table.</p></li>
<li><p><code>borders</code>: Total length of shared borders with neighbouring countries in km.</p></li>
<li><p><code>border_risk</code>: The risk of introduction based on the emission risk of neighbouring countries,
its values are in the range [0, 12].</p></li>
<li><p><code>geometry</code>: The geometry column containing the shared border, a <code>MULTIPOLYGON</code>.</p></li>
</ul><p>This dataset also has a <strong>number of attributes</strong>, the first is a dataset, the other 3
are used in other functions from <code>riskintroanalysis</code> to make passing dataset metadata
between functions more user-friendly.</p><ol><li><p><code>borders</code>: an <code>sf</code> object containing shared borders between EUs and bordering countries.
The table is containing the following columns:</p><ul><li><p><code>eu_id</code>: ID of the epidemiological unit.</p></li>
<li><p><code>bc_id</code>: ISO3 of the bordering country.</p></li>
<li><p><code>border_length</code>: Length of the shared border, use <a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">units::units</a> to get
the units. It is expected in km.</p></li>
<li><p><code>geometry</code>: The geometry column containing the shared border, a <code>MULTILINESTRING</code> or a
<code>LINESTRING</code>.</p></li>
</ul></li>
<li><p><code>table_name = "border_risk"</code>: the name of the table in the riskintroanalysis
data model. This is used by other functions in  <code>riskintroanalysis</code>, such as <code>plot_risk</code>.</p></li>
<li><p><code>risk_col = "border_risk"</code>: the name of the risk score column in the dataset.
This is used by other functions in  <code>riskintroanalysis</code>, such as <code>plot_risk</code>.</p></li>
<li><p><code>scale = c(0,12)</code>: the scale of <code>risk_col</code> used for other functions such
as <code>rescale_risk_score</code> and <code>plot_risk</code>.</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tunisia_raw</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"riskintrodata"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"samples"</span>, <span class="st">"tunisia"</span>, <span class="st">"epi_units"</span>, <span class="st">"tunisia_adm2_raw.gpkg"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply mapping to prepare colnames and validate dataset</span></span></span>
<span class="r-in"><span><span class="va">tunisia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/apply_mapping.html" class="external-link">apply_mapping</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tunisia_raw</span>,</span></span>
<span class="r-in"><span>  mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/mapping_epi_units.html" class="external-link">mapping_epi_units</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    eu_name <span class="op">=</span> <span class="st">"NAME_2"</span>,</span></span>
<span class="r-in"><span>    geometry <span class="op">=</span> <span class="st">"geom"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  validate <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> All data in "epi_units" valided.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tun_neighbours</span> <span class="op">&lt;-</span> <span class="fu">riskintrodata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/riskintrodata/man/neighbours_table.html" class="external-link">neighbours_table</a></span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country_id</span> <span class="op">==</span> <span class="st">"TUN"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bordering_countries</span> <span class="op">&lt;-</span> <span class="fu">riskintrodata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/riskintrodata/man/world_sf.html" class="external-link">world_sf</a></span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">iso3</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="va">tun_neighbours</span><span class="op">$</span><span class="va">neighbour_id</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">iso3</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="st">"LBY"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run function to get shared borders</span></span></span>
<span class="r-in"><span><span class="va">shared_borders</span> <span class="op">&lt;-</span> <span class="fu"><a href="calc_border_lengths.html">calc_border_lengths</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  epi_units <span class="op">=</span> <span class="va">tunisia</span>,</span></span>
<span class="r-in"><span>  eu_id_col <span class="op">=</span> <span class="st">"eu_id"</span>,</span></span>
<span class="r-in"><span>  bordering_countries <span class="op">=</span> <span class="va">bordering_countries</span>,</span></span>
<span class="r-in"><span>  bc_id_col <span class="op">=</span> <span class="st">"iso3"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">wahis_factors</span> <span class="op">&lt;-</span> <span class="fu">riskintrodata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/get_wahis_erf.html" class="external-link">get_wahis_erf</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  disease <span class="op">=</span> <span class="st">"Anthrax"</span>,</span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="st">"Cattle"</span>,</span></span>
<span class="r-in"><span>  animal_category <span class="op">=</span> <span class="st">"Domestic"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> All data in "emission_risk_factors" valided.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> WAHIS emission risk factors dataset has 65 entries for `disease = Anthrax`, `species = Cattle`, and `animal_category = Domestic`.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">emission_risk_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="calc_emission_risk.html">calc_emission_risk</a></span><span class="op">(</span><span class="va">wahis_factors</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ri_border</span> <span class="op">&lt;-</span> <span class="fu">calc_border_risk</span><span class="op">(</span></span></span>
<span class="r-in"><span>  epi_units <span class="op">=</span> <span class="va">tunisia</span>,</span></span>
<span class="r-in"><span>  shared_borders <span class="op">=</span> <span class="va">shared_borders</span>,</span></span>
<span class="r-in"><span>  emission_risk <span class="op">=</span> <span class="va">emission_risk_table</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ri_border</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 268 features and 4 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: GEOMETRY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 7.530076 ymin: 30.23681 xmax: 11.59826 ymax: 37.55986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 268 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    eu_id    eu_name            borders border_risk                      geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;GEOMETRY [°]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> eu-00001 Ariana Médina           <span style="color: #BB0000;">NA</span>           0 POLYGON ((10.13862 36.89432,…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> eu-00002 Ettadhamen              <span style="color: #BB0000;">NA</span>           0 POLYGON ((10.05623 36.84281,…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> eu-00003 Kalaat El Andalous      <span style="color: #BB0000;">NA</span>           0 MULTIPOLYGON (((10.13862 36.…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> eu-00004 Mnihla                  <span style="color: #BB0000;">NA</span>           0 POLYGON ((10.13109 36.88332,…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> eu-00005 Raoued                  <span style="color: #BB0000;">NA</span>           0 POLYGON ((10.17025 36.88844,…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> eu-00006 Sebkhet Ariana          <span style="color: #BB0000;">NA</span>           0 POLYGON ((10.27149 36.88916,…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> eu-00007 Sidi Thabet             <span style="color: #BB0000;">NA</span>           0 POLYGON ((10.00166 36.99815,…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> eu-00008 Soukra                  <span style="color: #BB0000;">NA</span>           0 POLYGON ((10.20232 36.85612,…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> eu-00009 Amdoun                  <span style="color: #BB0000;">NA</span>           0 POLYGON ((9.136977 36.87276,…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> eu-00010 Béja Nord               <span style="color: #BB0000;">NA</span>           0 POLYGON ((9.091034 36.70194,…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 258 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">border_lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract-analysis.html">extract_border</a></span><span class="op">(</span><span class="va">ri_border</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">border_lines</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 3 features and 9 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: GEOMETRY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 9.557298 ymin: 30.23681 xmax: 11.59826 ymax: 33.15514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   eu_id bc_id border_length                  geometry weight country data_source</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;GEOMETRY [°]&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> eu-0… LBY            130. LINESTRING (11.56026 33.…      1 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> eu-0… LBY            143. MULTILINESTRING ((10.615…      1 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> eu-0… LBY            176. LINESTRING (10.13751 31.…      1 <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 3 more variables: emission_risk &lt;dbl&gt;, border_risk &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   border_label &lt;list&gt;</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eli Daniels, David Gohel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

