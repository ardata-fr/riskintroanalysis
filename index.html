<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis Methods for Managing Animal Disease Introduction Risk • riskintroanalysis</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Open_Sans-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Analysis Methods for Managing Animal Disease Introduction Risk">
<meta name="description" content="The riskintroanalysis R package provides functions to analyse the risk of introduction of animal diseases within a geographic area.">
<meta property="og:description" content="The riskintroanalysis R package provides functions to analyse the risk of introduction of animal diseases within a geographic area.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">riskintroanalysis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2.002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/ri-entry-point-risk.html">Entry points analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><ul>
<li><a href="#id_1-riskintroanalysis">1 riskintroanalysis</a></li>
<li><a href="#id_2-installation">2 Installation</a></li>
<li><a href="#id_3-analysis">3 Analysis</a></li>
<li>
<a href="#id_4-example-1-tunisia">4 Example 1: Tunisia</a>
<ul>
<li>
<a href="#id_41-core-datasets">4.1 Core datasets</a>
<ul>
<li><a href="#id_411-emission-risk-factors">4.1.1 Emission Risk Factors:</a></li>
<li><a href="#id_412-epidemiological-units">4.1.2 Epidemiological Units</a></li>
</ul>
</li>
<li>
<a href="#id_42-analysis">4.2 Analysis</a>
<ul>
<li><a href="#id_421-border-risk">4.2.1 Border risk</a></li>
<li><a href="#id_422-entry-point-risk">4.2.2 Entry point risk</a></li>
<li><a href="#id_423-animal-mobility">4.2.3 Animal mobility</a></li>
<li><a href="#id_424-road-accessibility">4.2.4 Road accessibility</a></li>
</ul>
</li>
<li><a href="#id_43-risk-rescaling">4.3 Risk rescaling</a></li>
<li>
<a href="#id_44-non-default-risks">4.4 Non-default risks</a>
<ul>
<li><a href="#id_441-risk-from-raster-file">4.4.1 Risk from raster file</a></li>
</ul>
</li>
<li><a href="#id_45-summary-table">4.5 Summary table</a></li>
</ul>
</li>
</ul>
<!-- README.md is generated from README.Rmd. Please edit that file --><div class="section level1">
<div class="page-header"><h1 id="id_1-riskintroanalysis">1 riskintroanalysis<a class="anchor" aria-label="anchor" href="#id_1-riskintroanalysis"></a>
</h1></div>
<p>The riskintroanalysis R package provides functions to analyse the risk of introduction of animal diseases within a geographic area. It is intended to be useful as a stand-alone package, but also to integrate directly into the riskintro Rshiny app. The motivation behind these projects is to easily conduct geospatial risk analysis using existing data from WAHIS (World Animal Health Information System).</p>
</div>
<div class="section level1">
<h1 id="id_2-installation">2 Installation<a class="anchor" aria-label="anchor" href="#id_2-installation"></a>
</h1>
<p>You can install the development version of riskintroanalysis like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"riskintroanalysis"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="id_3-analysis">3 Analysis<a class="anchor" aria-label="anchor" href="#id_3-analysis"></a>
</h1>
<p>The package provides functions for certain risk of introduction analysis, but requires external data to be provided. The functions are inteded to be flexible, but each analytical method requires the corresponding data.</p>
<p>The RShiny app <a href="https://github.com/ardata-fr/riskintro" class="external-link">riskintro</a> provides a graphical interface for the following analyses.</p>
<p>The central datasets to each method are:</p>
<ol style="list-style-type: decimal">
<li>
<strong>The emission risk score table</strong>, which provides a risk of emission diseases (that is to say the risk of a disease spreading from that country). This score is based on summary of risk factors, many of which are available from WAHIS (see more <a href="insert%20link%20to%20riksintrodata%20package%20docs">here</a>). This data exists for many countries around the world, and is augmented with geospatial data corresponding to each country’s administrative boundaries.</li>
<li>
<strong>The area of interest</strong>, Geospatial data defining the borders of a region. This is the area for which we want to know the risk of introduction of a disease. The most common data is that of a country and its administrative boundaries, including internal boundaries. For example, French departments, or German states.</li>
</ol>
<p>These two datasets are used along with other data to calculate risk scores for the following analyses:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Border lengths</strong>: using the length of shared borders the risk of introduction is weighed comared to each neighbouring country and their risk score.</li>
<li>
<strong>Border entry points</strong>: using an additional dataset that defines broder entry points, risk of introduction is weighted by legality of entry point.</li>
<li>
<strong>Animal mobility</strong>: using an additional dataset defining legal animal commerce flows, risk of introduction is weighed based on the number of animals entering the area.</li>
</ol>
<p>The forth analysis method does not use emission risk data, just data from a road accesibility raster and the epidemiological units:</p>
<ol start="4" style="list-style-type: decimal">
<li>
<strong>Road access risk</strong>: using raster data of the world, applied to the area of interest, risk of introdcution is infered through road acces. An area more accessible by road is considered higher risk.</li>
</ol>
<p>These methods of analysis are intended to be used together or individually to montor is risk of introduction. This is done by ensuring risks are using the same scale (for example between 0 and 100) and they can easily added to a table of risk.</p>
<p>Additionally, some tools are provided to add other risk (such as the ones not show above). Currently supported are pre-calculated risks or risks from raster files. Which can be rescaled and added to the risk table as well. This allows of the risk analyst the flexibility to add other risks outside of the default risks.</p>
</div>
<div class="section level1">
<h1 id="id_4-example-1-tunisia">4 Example 1: Tunisia<a class="anchor" aria-label="anchor" href="#id_4-example-1-tunisia"></a>
</h1>
<p><code>riskintroanalysis</code> is intended to be used alongside <code>sf</code> geospatial data manipulation, <code>dplyr</code> for general data manipulation, and <code>terra</code> for raster data.</p>
<div class="section level2">
<h2 id="id_41-core-datasets">4.1 Core datasets<a class="anchor" aria-label="anchor" href="#id_41-core-datasets"></a>
</h2>
<p>The two core datasets are emission risk factors and epidemiological units. The first is used in three out of four analysis methods, the second is used in all of them.</p>
<div class="section level3">
<h3 id="id_411-emission-risk-factors">4.1.1 Emission Risk Factors:<a class="anchor" aria-label="anchor" href="#id_411-emission-risk-factors"></a>
</h3>
<p>Emission risk factors are used to create an overall emission risk value that is associated with the possible spread of a disease from that country. It is made up of multiple scores which are weighted.</p>
<p>Here, we create two entries in the emission risk table for Algeria and Libya. The absence of government oversight in each area represents an increased risk of emission. Therefore a 1 means there is additional risk associated with this score, and a 0 means no additional risk.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">riskintrodata</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">riskintroanalysis</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">algeria</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/erf_row.html" class="external-link">erf_row</a></span><span class="op">(</span></span>
<span>  iso3 <span class="op">=</span> <span class="st">"DZA"</span>,</span>
<span>  country <span class="op">=</span> <span class="st">"Algeria"</span>,</span>
<span>  disease <span class="op">=</span> <span class="st">"Avian infectious laryngotracheitis"</span>,</span>
<span>  animal_category <span class="op">=</span> <span class="st">"Domestic"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Birds"</span>,</span>
<span>  disease_notification <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  targeted_surveillance <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  general_surveillance <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  screening <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  precautions_at_the_borders <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  slaughter <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  selective_killing_and_disposal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  zoning <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  official_vaccination <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  last_outbreak_end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"30/06/2023"</span><span class="op">)</span>,</span>
<span>  commerce_illegal <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  commerce_legal <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ All data in "emission_risk_factors" valided.</span></span>
<span></span>
<span><span class="va">libya</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/erf_row.html" class="external-link">erf_row</a></span><span class="op">(</span></span>
<span>  iso3 <span class="op">=</span> <span class="st">"LBY"</span>,</span>
<span>  country <span class="op">=</span> <span class="st">"Libya"</span>,</span>
<span>  disease <span class="op">=</span> <span class="st">"Avian infectious laryngotracheitis"</span>,</span>
<span>  animal_category <span class="op">=</span> <span class="st">"Domestic"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Birds"</span>,</span>
<span>  disease_notification <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  targeted_surveillance <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  general_surveillance <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  screening <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  precautions_at_the_borders <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  slaughter <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  selective_killing_and_disposal <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  zoning <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  official_vaccination <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  last_outbreak_end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"30/06/2019"</span><span class="op">)</span>,</span>
<span>  commerce_illegal <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  commerce_legal <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ All data in "emission_risk_factors" valided.</span></span>
<span></span>
<span><span class="va">wahis_erf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/get_wahis_erf.html" class="external-link">get_wahis_erf</a></span><span class="op">(</span></span>
<span>    disease <span class="op">=</span> <span class="st">"Avian infectious laryngotracheitis"</span>,</span>
<span>    animal_category <span class="op">=</span> <span class="st">"Domestic"</span>,</span>
<span>    species <span class="op">=</span> <span class="st">"Birds"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ✔ All data in "emission_risk_factors" valided.</span></span>
<span><span class="co">#&gt; ✔ WAHIS emission risk factors dataset has 62 entries for `disease = Avian infectious laryngotracheitis`, `species = Birds`, and `animal_category = Domestic`.</span></span>
<span></span>
<span><span class="va">emission_risk_factors</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">algeria</span>, </span>
<span>  <span class="va">libya</span>,</span>
<span>  <span class="va">wahis_erf</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">emission_risk_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calc_emission_risk.html">calc_emission_risk</a></span><span class="op">(</span>emission_risk_factors <span class="op">=</span> <span class="va">emission_risk_factors</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span></span>
<span>  <span class="va">emission_risk_table</span><span class="op">$</span><span class="va">emission_risk</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Histogram of emission risk score"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Emission risk scores"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-emission-risk-loading-1.png" width="100%"></p>
<p>It is also useful to join the world_sf geospatial dataset to emission risk for later.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">world</span> <span class="op">&lt;-</span> <span class="fu">riskintrodata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/riskintrodata/man/world_sf.html" class="external-link">world_sf</a></span></span>
<span></span>
<span><span class="va">emission_risk_sf</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">world</span>, y <span class="op">=</span> <span class="va">emission_risk_table</span>, </span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iso3"</span> <span class="op">=</span> <span class="st">"iso3"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">emission_risk_sf</span>, <span class="va">emission_risk</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Emission risk scores"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-display-world-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="id_412-epidemiological-units">4.1.2 Epidemiological Units<a class="anchor" aria-label="anchor" href="#id_412-epidemiological-units"></a>
</h3>
<p>Epidemiological units (or epi units for short) is the term used for geographical areas of interests for analysing understand the risk of introduction. This data has no defaults and needs to be provided by the user, however packages like <code>geodata</code> can be used to get them. For this example, a shapefile containing the administrative boundaries of Tunisia exists in the <code>riskintrodata</code> package for demonstration purposes.</p>
<p>The Tunisia epidemiological units dataset will be essential to the following analysis methods.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co"># Example with raw sf files, previously downloaded with geodata::gadm()</span></span>
<span><span class="va">tunisia_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  package <span class="op">=</span> <span class="st">"riskintrodata"</span>,</span>
<span>  <span class="st">"samples"</span>, <span class="st">"tunisia"</span>, <span class="st">"epi_units"</span>, <span class="st">"tunisia_adm2_raw.gpkg"</span></span>
<span>   <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply mapping to prepare colnames and validate dataset</span></span>
<span><span class="va">tunisia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/apply_mapping.html" class="external-link">apply_mapping</a></span><span class="op">(</span></span>
<span>  <span class="va">tunisia_raw</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/mapping_epi_units.html" class="external-link">mapping_epi_units</a></span><span class="op">(</span></span>
<span>    eu_name <span class="op">=</span> <span class="st">"NAME_2"</span>,</span>
<span>    geometry <span class="op">=</span> <span class="st">"geom"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ All data in "epi_units" valided.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">tunisia</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-epi-units-1.png" width="100%"> What’s left after using <code><a href="https://rdrr.io/pkg/riskintrodata/man/apply_mapping.html" class="external-link">apply_mapping()</a></code> is the required “epi_units” dataset that is compatible with the rest of the analysis going forward.</p>
</div>
</div>
<div class="section level2">
<h2 id="id_42-analysis">4.2 Analysis<a class="anchor" aria-label="anchor" href="#id_42-analysis"></a>
</h2>
<p>The 4 methods of analysis provided by the package are detailed below:</p>
<p>This an example of analysing the risk of introduction for Tunisian governorates. Based off of the core datasets</p>
<div class="section level3">
<h3 id="id_421-border-risk">4.2.1 Border risk<a class="anchor" aria-label="anchor" href="#id_421-border-risk"></a>
</h3>
<p>Required datasets:</p>
<ol style="list-style-type: decimal">
<li>epi units</li>
<li>internal neighbours table</li>
<li>emission risk table</li>
</ol>
<p>The border length method calculates the risk of introduction of an animal disease for a certain species based on shared land borders. In this example, we see Tunisia shares land borders with Algeria and Libya (this is why entries of these two countries were added to the emission risk table above).</p>
<p>Risk of introduction through land borders is the risk of emission from of bordering countries weighted by the length of the shared border. If an epi unit only has one bordering country with emission risk X, then the epi units risk of introduction is also X. If two bordering countries exist with emission risk Y ans Z, then the risk of introduction is a weighted average of Y and Z, with more importance given to the country with the longer border.</p>
<p>The analysis method starts with finding shared borders between epidemiological units and bordering countries, which requires an algorithm align borders.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run function to get shared borders</span></span>
<span><span class="va">shared_borders</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calc_border_lengths.html">calc_border_lengths</a></span><span class="op">(</span></span>
<span>  epi_units <span class="op">=</span> <span class="va">tunisia</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get bordering countries to display on ggplot</span></span>
<span><span class="co"># (This is internal to calc_border_lengths() function)</span></span>
<span><span class="va">bordering_countries</span> <span class="op">&lt;-</span> <span class="fu">riskintrodata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/riskintrodata/man/neighbours_table.html" class="external-link">neighbours_table</a></span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country_id</span> <span class="op">==</span> <span class="st">"TUN"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="fu">riskintrodata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/riskintrodata/man/world_sf.html" class="external-link">world_sf</a></span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"neighbour_id"</span> <span class="op">=</span> <span class="st">"iso3"</span><span class="op">)</span><span class="op">)</span></span>
<span>            </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bordering_countries</span>, colour <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="st">"pink"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tunisia</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, colour <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">shared_borders</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf_label</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">shared_borders</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.fkm"</span>, <span class="va">border_length</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">12</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">38</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span></code></pre></div>
<p><img src="reference/figures/README-shared-borders-1.png" width="100%"></p>
<p>The main purpose of the function is to correct misaligned borders, as can be seen in the overlaps and divergent borders. The epidemiological units data is used for the “true” border as geospatial data from different sources are rarely well aligned.</p>
<p>A border length has been calculated for each epi unit that a foreign country. For most of these areas, the risk of introduction will simply equal the emission risk of the neighbouring country, with the exception of Tunisia’s southern most governorate. Which will have an emission risk weighed by the border lengths or each neighbour.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ri_borders</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calc_border_risk.html">calc_border_risk</a></span><span class="op">(</span></span>
<span>  epi_units <span class="op">=</span> <span class="va">tunisia</span>, </span>
<span>  shared_borders <span class="op">=</span> <span class="va">shared_borders</span>,</span>
<span>  emission_risk <span class="op">=</span> <span class="va">emission_risk_table</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_risk.html">plot_risk</a></span><span class="op">(</span><span class="va">ri_borders</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-border-risk-analysis-1.png" width="100%"></p>
<p>We can see that Remada has a risk of introduction weighted by border lengths. The numbers shown along the borders are the emission risk weighted by border lengths with neighbouring countries of Algeria and Libya. As on Remada shares borders with both countries, it is the only one with a weighted average.</p>
</div>
<div class="section level3">
<h3 id="id_422-entry-point-risk">4.2.2 Entry point risk<a class="anchor" aria-label="anchor" href="#id_422-entry-point-risk"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">riskintroanalysis</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">entry_points_fp</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>      package <span class="op">=</span> <span class="st">"riskintrodata"</span>,</span>
<span>      <span class="st">"samples"</span>,</span>
<span>      <span class="st">"tunisia"</span>,</span>
<span>      <span class="st">"entry_points"</span>, <span class="st">"BORDER_CROSSING_POINTS.csv"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">entry_points</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">entry_points_fp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 110 Columns: 6</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr (4): NAME, TYPE, MODE, SOURCES</span></span>
<span><span class="co">#&gt; dbl (2): LONGITUDE_X, LATITUDE_Y</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="va">entry_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/apply_mapping.html" class="external-link">apply_mapping</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="va">entry_points</span>, </span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/mapping_entry_points.html" class="external-link">mapping_entry_points</a></span><span class="op">(</span></span>
<span>    point_name <span class="op">=</span> <span class="st">"NAME"</span>, </span>
<span>    lng <span class="op">=</span> <span class="st">"LONGITUDE_X"</span>, </span>
<span>    lat <span class="op">=</span> <span class="st">"LATITUDE_Y"</span>,</span>
<span>    mode <span class="op">=</span> <span class="st">"MODE"</span>, </span>
<span>    type <span class="op">=</span> <span class="st">"TYPE"</span>, </span>
<span>    sources <span class="op">=</span> <span class="st">"SOURCES"</span></span>
<span>  <span class="op">)</span>, </span>
<span>  validate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ All data in "entry_points" valided.</span></span>
<span></span>
<span><span class="va">ri_entry_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calc_entry_point_risk.html">calc_entry_point_risk</a></span><span class="op">(</span></span>
<span>  entry_points <span class="op">=</span> <span class="va">entry_points</span>,</span>
<span>  epi_units <span class="op">=</span> <span class="va">tunisia</span>,</span>
<span>  emission_risk <span class="op">=</span> <span class="va">emission_risk_table</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: ! There are missing emission risk scores for the following countries:</span></span>
<span><span class="co">#&gt; • BIH missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • BRN missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • ESP missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • FRA missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • HUN missing for 2 entry points.</span></span>
<span><span class="co">#&gt; • ISR missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • MAR missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • NOR missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • PAN missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • PER missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • PHL missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • VNM missing for 1 entry points.</span></span>
<span><span class="co">#&gt; • ZAF missing for 1 entry points.</span></span>
<span><span class="co">#&gt; Create new entries in the emission risk factor table using `erf_row()`</span></span>
<span><span class="co">#&gt; (`?riskintrodata::erf_row()`).</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_risk.html">plot_risk</a></span><span class="op">(</span><span class="va">ri_entry_points</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-entry-points-analysis-1.png" width="100%"></p>
<p>All epi units containing an entry point (with an associated weighted emission risk) now have a risk of introduction based on the points within its area.</p>
</div>
<div class="section level3">
<h3 id="id_423-animal-mobility">4.2.3 Animal mobility<a class="anchor" aria-label="anchor" href="#id_423-animal-mobility"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">riskintroanalysis</span><span class="op">)</span></span>
<span><span class="va">animal_mobility_fp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"riskintrodata"</span>, <span class="st">"samples"</span>, <span class="st">"tunisia"</span>, <span class="st">"animal_mobility"</span>, <span class="st">"ANIMAL_MOBILITY_raw.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">animal_mobility_raw</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">animal_mobility_fp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 112 Columns: 11</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr (6): ORIGIN_NAME, ORIGIN_COUNTRY, ORIGIN_ISO3, DESTINATION_NAME, DESTINA...</span></span>
<span><span class="co">#&gt; dbl (5): ORIGIN_LONGITUDE_X, ORIGIN_LATITUDE_Y, DESTINATION_LONGITUDE_X, DES...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="va">animal_mobility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/apply_mapping.html" class="external-link">apply_mapping</a></span><span class="op">(</span></span>
<span>  <span class="va">animal_mobility_raw</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/mapping_animal_mobility.html" class="external-link">mapping_animal_mobility</a></span><span class="op">(</span></span>
<span>    o_name <span class="op">=</span> <span class="st">"ORIGIN_NAME"</span>,</span>
<span>    o_lng <span class="op">=</span> <span class="st">"ORIGIN_LONGITUDE_X"</span>,</span>
<span>    o_lat <span class="op">=</span> <span class="st">"ORIGIN_LATITUDE_Y"</span>,</span>
<span>    d_name <span class="op">=</span> <span class="st">"DESTINATION_NAME"</span>,</span>
<span>    d_lng <span class="op">=</span> <span class="st">"DESTINATION_LONGITUDE_X"</span>,</span>
<span>    d_lat <span class="op">=</span> <span class="st">"DESTINATION_LATITUDE_Y"</span>,</span>
<span>    quantity <span class="op">=</span> <span class="st">"HEADCOUNT"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ All data in "animal_mobility" valided.</span></span>
<span></span>
<span><span class="va">ri_animal_mobility</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calc_animal_mobility_risk.html">calc_animal_mobility_risk</a></span><span class="op">(</span></span>
<span>  animal_mobility <span class="op">=</span> <span class="va">animal_mobility</span>, </span>
<span>  emission_risk <span class="op">=</span> <span class="va">emission_risk_table</span>, </span>
<span>  epi_units <span class="op">=</span> <span class="va">tunisia</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: ! There are missing emission risk scores for the following countries:</span></span>
<span><span class="co">#&gt; • CAN missing for 1 animal mobility flows.</span></span>
<span><span class="co">#&gt; • PER missing for 1 animal mobility flows.</span></span>
<span><span class="co">#&gt; • SEN missing for 1 animal mobility flows.</span></span>
<span><span class="co">#&gt; Create new entries in the emission risk factor table using `erf_row()`</span></span>
<span><span class="co">#&gt; (`?riskintrodata::erf_row()`).</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_risk.html">plot_risk</a></span><span class="op">(</span><span class="va">ri_animal_mobility</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-animal-mobility-analysis-1.png" width="100%"></p>
<p>Some points remain grey indicating that the country from which the flow comes does not have an entry in the emission risk factors table.</p>
</div>
<div class="section level3">
<h3 id="id_424-road-accessibility">4.2.4 Road accessibility<a class="anchor" aria-label="anchor" href="#id_424-road-accessibility"></a>
</h3>
<p>Road access risk is calculated from the road accessibility raster file, a global raster that contains data of distance from roads. This data is aggregated over each epidemiological unit of Tunisia.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">riskintroanalysis</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.8.60</span></span>
<span></span>
<span><span class="fu">riskintrodata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/init_riskintrodata_cache.html" class="external-link">init_riskintrodata_cache</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/home/runner/.local/share/R/riskintrodata"</span></span>
<span><span class="va">road_raster_fp</span> <span class="op">&lt;-</span> <span class="fu">riskintrodata</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/riskintrodata/man/download_road_access_raster.html" class="external-link">download_road_access_raster</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">road_raster</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">road_raster_fp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ri_road_access</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calc_road_access_risk.html">calc_road_access_risk</a></span><span class="op">(</span></span>
<span>  epi_units <span class="op">=</span> <span class="va">tunisia</span>, </span>
<span>  road_access_raster <span class="op">=</span> <span class="va">road_raster</span>, </span>
<span>  aggregate_fun <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="reference/extract-analysis.html">extract_raster</a></span><span class="op">(</span><span class="va">ri_road_access</span><span class="op">)</span>, </span>
<span>  main <span class="op">=</span> <span class="st">"Raster cropped to epidemiological units"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-display-raster-1.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_risk.html">plot_risk</a></span><span class="op">(</span><span class="va">ri_road_access</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-display-raster-2.png" width="100%"></p>
<p>This shows us what the raster data looks like for Tunisia. Now we will aggragate these values over each administrative area. Here, mean is used.</p>
<p>The output shows the road access risk associated with each epidemiological unit.</p>
</div>
</div>
<div class="section level2">
<h2 id="id_43-risk-rescaling">4.3 Risk rescaling<a class="anchor" aria-label="anchor" href="#id_43-risk-rescaling"></a>
</h2>
<p>Once all the analysis methods have given a result, we need to be able to compare them. Notably, road access risk is not on the same 0 to 12 scale as the other three analyses. You might also want to add your own risk scores using other methods.</p>
<p>To make sure we can compare across risks, riskintro proposes the <code>rescale_risk</code> function, whose primary purpose is to normalise risk scores to a range between 0 and 100. Its secondary role is to transform the risk distribution using quadratic, exponential or sigmoid functions (and inverse versions of these). Other options include reversing the scaling as well.</p>
<p>A linear transformation looks like the following. This uses the maximum value of <code>road_access_risk</code> as the top of the range, whereas it could be better to take the global maximum in the raster if you are intending to comparing across countries later.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rescaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rescale_risk_scores.html">rescale_risk_scores</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="va">ri_road_access</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"road_access_risk"</span>,</span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ri_road_access</span><span class="op">$</span><span class="va">road_access_risk</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"linear"</span>, </span>
<span>  names_to <span class="op">=</span> <span class="st">"scaled_road_access_risk"</span>,</span>
<span>  keep_cols <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rescaled</span><span class="op">$</span><span class="va">road_access_risk</span>, <span class="va">rescaled</span><span class="op">$</span><span class="va">scaled_road_access_risk</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-rescaling-road-access-risk-1-1.png" width="100%"></p>
<p>While a sigmoid transformation looks like the below. The choice of the <code>method</code> argument are left up to the judgement of the analyst.</p>
<p>Note that a risk dataset ouput from one of the 4 default risk analyses will detect which column to scale. The <code>cols</code> and <code>names_to</code> arguments are not required.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ri_road_access_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rescale_risk_scores.html">rescale_risk_scores</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ri_road_access</span>,</span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ri_road_access</span><span class="op">$</span><span class="va">road_access_risk</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"sigmoid"</span>, </span>
<span>  keep_cols <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="id_44-non-default-risks">4.4 Non-default risks<a class="anchor" aria-label="anchor" href="#id_44-non-default-risks"></a>
</h2>
<p>Riskintro also provides more generic workflows for adding any sort of risk scores to a risk table alongside the default risk.</p>
<div class="section level3">
<h3 id="id_441-risk-from-raster-file">4.4.1 Risk from raster file<a class="anchor" aria-label="anchor" href="#id_441-risk-from-raster-file"></a>
</h3>
<p>First, import or generate the raster data to use for analysis. This example generates fictitious water courses in Tunisia which could be a source of introduction risk.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="va">tun_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">12</span>, <span class="fl">30</span>, <span class="fl">38</span><span class="op">)</span></span>
<span><span class="va">r_tun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">tun_ext</span>, res <span class="op">=</span> <span class="fl">0.1</span>, crs <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span>
<span><span class="va">wkt_lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"LINESTRING (9.0 36.0, 9.5 35.0, 10.0 34.5)"</span>,</span>
<span>  <span class="st">"LINESTRING (8.5 33.5, 9.0 33.0, 10.0 32.5)"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">water_sv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>wkt <span class="op">=</span> <span class="va">wkt_lines</span><span class="op">)</span>,</span>
<span>                 geom <span class="op">=</span> <span class="st">"wkt"</span>,</span>
<span>                 crs  <span class="op">=</span> <span class="st">"EPSG:4326"</span><span class="op">)</span></span>
<span><span class="va">water_sv</span><span class="op">$</span><span class="va">water</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">water_rast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rasterize.html" class="external-link">rasterize</a></span><span class="op">(</span></span>
<span>  <span class="va">water_sv</span>,</span>
<span>  <span class="va">r_tun</span>,</span>
<span>  field      <span class="op">=</span> <span class="st">"water"</span>,</span>
<span>  background <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">water_rast</span>, main <span class="op">=</span> <span class="st">"Example watercourses"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tunisia</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ri_water</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/augment_epi_units_with_raster.html">augment_epi_units_with_raster</a></span><span class="op">(</span></span>
<span>  epi_units <span class="op">=</span> <span class="va">tunisia</span>, </span>
<span>  raster <span class="op">=</span> <span class="va">water_rast</span>, </span>
<span>  risk_name <span class="op">=</span> <span class="st">"water_risk"</span>, </span>
<span>  aggregate_fun <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/rescale_risk_scores.html">rescale_risk_scores</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="st">"water_risk"</span>, </span>
<span>    from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>    to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>, </span>
<span>    method <span class="op">=</span> <span class="st">"quadratic"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ri_water</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">water_risk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"> ### Pre-calculated risk</p>
<p>In the case an analyst already has a dataset will risk scores for each epidemiolocal unit, it is possible to simply join this dataset to the risk table assuming that:</p>
<ol style="list-style-type: decimal">
<li>a correct join key exists in the pre-calculated dataset and,</li>
<li>there is no more an one risk score associated with each epidemiological unit.</li>
</ol>
<p>Here we generate a dataset from a random uniform distribution</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ri_random</span> <span class="op">&lt;-</span> <span class="va">tunisia</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>my_key <span class="op">=</span> <span class="va">eu_id</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    ri_random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tunisia</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/rescale_risk_scores.html">rescale_risk_scores</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="st">"ri_random"</span>,</span>
<span>    from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"sigmoid"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="id_45-summary-table">4.5 Summary table<a class="anchor" aria-label="anchor" href="#id_45-summary-table"></a>
</h2>
<p>Once all the risk methods have been compiled and scaled similarly, it can be handy to have them all in one table. Each row is an epidemiological unit and its various risks scores.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initialise the risk_table </span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/risk_table.html">risk_table</a></span><span class="op">(</span><span class="va">tunisia</span>, scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Add risks that have already been rescaled</span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/add_risk.html">add_risk</a></span><span class="op">(</span>risk_table <span class="op">=</span> <span class="va">rt</span>, risk_data <span class="op">=</span> <span class="va">ri_road_access_scaled</span><span class="op">)</span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/add_risk.html">add_risk</a></span><span class="op">(</span>risk_table <span class="op">=</span> <span class="va">rt</span>, risk_data <span class="op">=</span> <span class="va">ri_water</span><span class="op">)</span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/add_risk.html">add_risk</a></span><span class="op">(</span>risk_table <span class="op">=</span> <span class="va">rt</span>, risk_data <span class="op">=</span> <span class="va">ri_random</span>, join_by <span class="op">=</span> <span class="st">"my_key"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add other risks, rescaling them as needed</span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/add_risk.html">add_risk</a></span><span class="op">(</span></span>
<span>  risk_table <span class="op">=</span> <span class="va">rt</span>,</span>
<span>  risk_data <span class="op">=</span> <span class="fu"><a href="reference/rescale_risk_scores.html">rescale_risk_scores</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">ri_entry_points</span>, </span>
<span>    method <span class="op">=</span> <span class="st">"sigmoid"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/add_risk.html">add_risk</a></span><span class="op">(</span></span>
<span>  risk_table <span class="op">=</span> <span class="va">rt</span>,</span>
<span>  risk_data <span class="op">=</span> <span class="fu"><a href="reference/rescale_risk_scores.html">rescale_risk_scores</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">ri_borders</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/add_risk.html">add_risk</a></span><span class="op">(</span></span>
<span>  risk_table <span class="op">=</span> <span class="va">rt</span>,</span>
<span>  risk_data <span class="op">=</span> <span class="fu"><a href="reference/rescale_risk_scores.html">rescale_risk_scores</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">ri_animal_mobility</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">summarised_risks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/summarise_risk_scores.html">summarise_risk_scores</a></span><span class="op">(</span><span class="va">rt</span>, method <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_risk.html">plot_risk</a></span><span class="op">(</span><span class="va">summarised_risks</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-summary-table-1.png" width="100%"></p>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing riskintroanalysis</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Eli Daniels <br><small class="roles"> Author, maintainer </small>   </li>
<li>David Gohel <br><small class="roles"> Author </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>This R package was developed by <a href="https://ardata.fr/" class="external-link">Ardata</a> for CIRAD to provide a tool for analysing geospatial epidemiological.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
